# 📘 Tailwind v4 리팩토링 기술 표준 가이드 (v2.0)

본 문서는 `refactor-expert` 에이전트가 Styled-components를 Tailwind v4로 마이그레이션할 때 준수해야 하는 기술적 표준 및 검증 규칙을 정의한다.

---

## 1. ⚠️ 테마 부재 시 대응 로직 (Missing Tokens)

리팩토링 중 `index.css`에 정의되지 않은 값(Hex 코드, 임의 간격 등)을 발견하면 독단적으로 판단하지 않고 다음 순서로 처리한다:

1. **토큰 탐색**: Figma MCP를 사용하여 해당 수치가 디자인 시스템의 다른 토큰(예: `Neutral/150`)에 명시되어 있는지 확인한다.
2. **테마 확장**: 디자인 시스템에 존재하는 값임이 확인되면, `index.css`의 `@theme` 블록에 시맨틱 네이밍 규칙에 맞춰 변수를 선언한 후 사용한다.
3. **사용자 컨설팅**: Figma와 `index.css` 모두에 없는 임의의 값인 경우, 작업을 중단하고 사용자에게 **"테마에 신규 추가할지, 혹은 가장 유사한 기존 토큰으로 대체할지"** 질문하여 결정한다.
4. **임의 값(Arbitrary values) 금지**: `text-[#333]`나 `w-[123px]`와 같은 대괄호 문법은 사용자의 명시적 허용 없이는 사용을 지양한다.

## 2. 🧩 코너 케이스(Corner Case) 기술 표준

-   **복잡한 애니메이션**: Styled-components의 `keyframes`는 `@theme` 내부의 `@keyframes`로 이관하며, `--animate-*` 변수로 등록하여 `animate-` 유틸리티 클래스로 호출한다.
-   **의존성 스타일**: 부모 요소의 상태에 따라 자식 스타일이 변경되는 경우, Tailwind의 `group` 및 `group-hover` 기능을 우선적으로 활용한다.
-   **동적 수치 제어**: 라이브러리 연동이나 계산 로직이 필요한 경우에만 인라인 `style` 속성을 허용하며, 그 외 모든 정적 스타일은 Tailwind 클래스로 변환한다.
-   **폰트 최적화**: 텍스트 스타일 적용 시 개별 속성(size, weight)을 나열하지 않고, 정의된 타이포그래피 유틸리티(`.text-h1`, `.text-b1` 등)를 우선 적용한다.

## 3. 🛠️ 컴포넌트 구현 표준 (CVA & CN)

-   **cn 유틸리티**: 클래스 병합 및 조건부 렌더링 시 반드시 프로젝트에 정의된 `cn` 함수(`tailwind-merge` + `clsx`)를 사용한다.
-   **CVA 구조**: 2개 이상의 변형(Variants)을 가진 컴포넌트는 반드시 `class-variance-authority`를 사용하여 선언적 구조를 유지한다.
-   **Props 매핑**: 기존의 Transient Props(예: `$isActive`)는 `cva`의 variant 인자로 매핑하여 마크업을 정제한다.

## 4. ✅ 최종 검증 및 품질 보증 (Self-Verification)

에이전트는 각 도메인/파일 변환 완료 후 다음 체크리스트를 수행하고 보고해야 한다:

-   [ ] **의존성 제거**: `styled-components` 또는 `@emotion` 관련 모든 임포트 및 스타일 정의가 삭제되었는가?
-   [ ] **토큰 무결성**: `className` 내부에 하드코딩된 값(`#`, `[` 등)이 남아있지 않은가?
-   [ ] **CVA/CN 적용**: 모든 조건부 스타일과 변형이 `cva`와 `cn`을 통해 일관되게 구현되었는가?
-   [ ] **TS 타입 안전성**: `VariantProps`를 사용하여 컴포넌트 Props와 스타일 변형 간의 타입 싱크가 일치하는가?
-   [ ] **잔류 검색**: `grep` 또는 `rg` 명령어를 통해 프로젝트 내 `styled.` 구문이 완전히 사라졌음을 확인했는가?

---

**주의:** 위 규칙 중 하나라도 위반될 가능성이 있거나 디자인 의도가 모호할 경우, 즉시 작업을 멈추고 사용자에게 가이드를 요청한다.
